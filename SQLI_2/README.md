# LEVEL1 Mango
### 문제 정보 : 이 문제는 데이터베이스에 저장된 플래그를 획득하는 문제입니다. 플래그는 admin 계정의 비밀번호 입니다. 플래그의 형식은 DH{…} 입니다. 
### {‘uid’: ‘admin’, ‘upw’: ‘DH{32alphanumeric}’}
----------------------------------------------------------------------------------------------
## STEP1 코드리뷰.
----------------------------------------------------------------------------------------------
### filter()
#### 입력 간에 admin과 dh, admi라는 단어는 포함될 수 없다는 구문이다.
### login()
#### uid, upw 입력시 DB로부터 결과를 반환 받는다.
![image](https://user-images.githubusercontent.com/81984723/186341136-2b5c8ad3-90df-4594-b8f2-08fd52de8a64.png)
![image](https://user-images.githubusercontent.com/81984723/186341208-bf66fd21-4579-4425-9e72-062408f13549.png)

----------------------------------------------------------------------------------------------
### def login()
#### admin 계정으로 접속할 경우에 플래그를 준다.
![image](https://user-images.githubusercontent.com/81984723/186337816-a16b2dec-b64a-4aef-b488-b39c07584c12.png)


## STEP3. 문제풀이
### (1) DBMS 종류의 확인
#### 로그인 페이지에 GET을 사용하는 Mongo DB
----------------------------------------------------------------------------------------------

### (2) DB 알고리즘의 동작 형태 확인
#### main.js 코드를 잘 살펴보면 플래그는 DB에 있으며 uid에 admin을, upw에 32자리의 알파뉴메릭 코드를 입력해야 한다는 것을 알 수 있다.
#### 때문에 해당 알파 뉴메릭 코드를 일일히 찾기에는 노가다 작업이 될 것 같아 익스플로잇 코드를 파이썬으로 작성하여 풀어야 한다.
----------------------------------------------------------------------------------------------

### (3) 파이썬 익스플로잇 코드
----------------------------------------------------------------------------------------------
#### URL은 로그인창으로 설정하여 정수와 아스키코드의 대문자, 소문자로 구별하여 변수를 생성
#### uid[$gt]=adm는 adm보다 큰 문자열을 출력하고 크기는 알파벳 순서대로 계산된다.
#### ex) A<B면 AB < AC 형식으로 작동
#### uid[$ne]=guest 는 adm보다 큰 문자열을 출력하고 admin이 아닌 guest가 먼저 출력되기에 guest가 아닌 문자열을 출력한다.
#### adm 보다 크고 guest 보다 작은 문자열을 요구시에 dreamhack 문자열이 출력되므로 해당 문자열 구간의 크기 설정을 위해 upw[$regex] 문을 삽입하여 upw에 {가 포함된 문자열을 출력한다.
#### 해당 방법을 통해 DB의 uid 중 admin 출력은 가능하나, upw는 출력되지 않기 때문에 아스키 코드를 하나씩 삽입하여 적절한 값들을 일일히 출력하여 플래그를 완성시킨다.
![image](https://user-images.githubusercontent.com/81984723/186342251-feca4a28-f946-4f6a-95ae-f7218c67bd96.png)
![image](https://user-images.githubusercontent.com/81984723/186344906-e4e7b84d-a898-4e94-8e91-cd4332e1cec2.png)
